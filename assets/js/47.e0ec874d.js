(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{350:function(e,t){e.exports={calcMaxMenuNestDepth:function e(t,n=0){var s;if(null==t||!t.nodes||0===(null==t||null===(s=t.nodes)||void 0===s?void 0:s.length))return n;let i=n;for(const s of t.nodes){const t=e(s,n+1);i=Math.max(i,t)}return i}}},393:function(e,t,n){},461:function(e,t,n){"use strict";n(393)},539:function(e,t,n){"use strict";n.r(t);n(20),n(21);var s=n(333),i=n.n(s),o=n(350),l={name:"MenuTreeview",components:{draggable:i.a},props:{nodes:{type:Array,default:()=>[]},errors:{type:Array,default:()=>[]},title:String,value:{type:null|Object,required:!1},maxDepth:{type:Number,default:-1},loading:Boolean},data(){return{inNodes:this.nodes,selected:this.value}},watch:{value(e){this.selected=e},selected(e){this.$emit("input",e)},nodes(e){this.inNodes=e},inNodes(e){this.$emit("update:nodes",e)}},methods:{move(e){let{draggedContext:{element:t}}=e,n=Object(o.calcMaxMenuNestDepth)(t)+ +e.to.dataset.depth;return!(this.maxDepth>0&&n>=this.maxDepth)},newNode(){var e,t;let n={new:!0,title:"",id:Math.random().toString(36).slice(2),nodes:[],meta:{},link:{relational:{}}};this.maxDepth>0&&this.currentDepth>=this.maxDepth?this.inNodes.push(n):this.selected?this.selected.nodes.push(n):this.inNodes.push(n),null===(e=this.$refs)||void 0===e||null===(t=e.nodes)||void 0===t||t.forEach(e=>e.openIfChild(n))},compareItems:(e,t)=>e&&t&&e.id===t.id,silentDeleteNode(e){var t,n;let s=(null===(t=this.selected)||void 0===t?void 0:t.id)==(null==e?void 0:e.id),i=null===(n=this.nodes)||void 0===n?void 0:n.findIndex(({id:t})=>t==e.id);var o,l;i>-1?(null===(o=this.nodes)||void 0===o||o.splice(i,1),this.selected=s?null:this.selected):this.selected=null!==(l=this.$refs.nodes)&&void 0!==l&&l.some(t=>t.deleteChild(e))&&s?null:this.selected},deleteNode(e){this.$mapo.$confirm.open({title:this.$t("mapo.delete"),question:this.$t("mapo.menuTreeview.areYouSureDelete"),approveButton:{text:this.$t("mapo.delete"),attrs:{color:"red",text:!0}}}).then(t=>t&&this.silentDeleteNode(e))},deleteSelectedNode(){return this.deleteNode(this.selected)}},computed:{currentDepth(){let e=(t,n=0)=>t.find(({id:e})=>{var t;return e==(null===(t=this.selected)||void 0===t?void 0:t.id)})?n+1:t.filter(({nodes:e})=>e.length).reduce((t,s)=>t>0?t:e(s.nodes,n+1),0);return this.selected?e(this.nodes):0}}},d=(n(461),n(1)),a=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"menu-treeview--wrapper"},[e._t("treeview.top",null,null,{newNode:e.newNode,nodes:e.nodes,value:e.value}),e._v(" "),t("div",{staticClass:"menu-treeview--tools"},[t("h5",[e._v(e._s(e.title))]),e._v(" "),t("div",[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:s}){return[t("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.newNode}},"v-btn",s,!1),n),[t("v-icon",[e._v("mdi-view-grid-plus")])],1)]}}])},[e._v(" "),t("span",[e._v(e._s(e.$t("mapo.menuTreeview.newNode")))])])],1)]),e._v(" "),t("v-list",{staticClass:"menu-treeview--main menu-treeview-node--list",attrs:{dense:""},nativeOn:{click:function(t){e.selected=null}}},[t("v-list-item-group",{attrs:{value:e.selected,"value-comparator":e.compareItems}},[t("draggable",{staticClass:"menu-treeview--main-draggable-wrapper",attrs:{emptyInsertThreshold:25,group:"nodes",move:e.move,draggable:".menu-treeview--draggable","data-depth":"0"},on:{start:function(t){e._dragging=!0},end:function(t){e._dragging=!1}},model:{value:e.inNodes,callback:function(t){e.inNodes=t},expression:"inNodes"}},e._l(e.inNodes,(function(n){return t("v-list-item",{key:n.id,staticClass:"menu-treeview--draggable",attrs:{value:n},on:{click:function(t){t.stopPropagation(),e.selected=n}}},[t("MenuTreeviewNode",{ref:"nodes",refInFor:!0,attrs:{node:n,selected:e.selected,"max-depth":e.maxDepth},on:{"update:selected":function(t){e.selected=t},delete:e.deleteNode,silentDelete:e.silentDeleteNode}})],1)})),1),e._v(" "),0==e.inNodes.length?t("div",{staticClass:"menu-treeview--empty",on:{click:e.newNode}},[t("v-icon",{attrs:{size:"40"}},[e._v(" mdi-view-grid-plus ")]),e._v(" "),t("p",[e._v(e._s(e.$t("mapo.menuTreeview.noRootNodes")))])],1):e._e()],1)],1),e._v(" "),e._t("treeview.bottom",null,null,{newNode:e.newNode,nodes:e.nodes,value:e.value})],2)}),[],!1,null,null,null);t.default=a.exports}}]);